//-----------------------------------------------------------------------------
// Project	    : Visual.Galaxy.Framework
//
//-----------------------------------------------------------------------------
// Programmer	: Christian "Tipplin" Kurs - 
//				: Visual .NET C# / C++ Developer
//              : Project-Founder and Maintainer
//-----------------------------------------------------------------------------
// Part         : VGF.Assembly
//              :
//-----------------------------------------------------------------------------
// Copyrights © 2017 - 2021 by Christian "Tipplin" Kurs
// Portions of Copyrights © 1982 - 2021 by Microsoft Corporation 
//-----------------------------------------------------------------------------
// Main-Author: Christian 'Tipplin' Kurs
//-----------------------------------------------------------------------------
// Disclaimer:
//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
// English
//-----------------------------------------------------------------------------
// Permission is hereby granted, free of charge, to any person obtaining a copy 
// of this software and associated documentation files (the "Software"), to deal 
// in the Software without restriction, including without limitation the rights 
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell 
// copies of the Software, and to permit persons to whom the Software is 
// furnished to do so, subject to the following conditions: 
// 
// The above copyright notice and this permission notice shall be included in 
// all copies or substantial portions of the Software. 
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE 
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN 
// THE SOFTWARE.
//-----------------------------------------------------------------------------
// Deutsch:
//-----------------------------------------------------------------------------
// Der Erlaubnis wird hiermit jedermann kostenlos eine Erlaubnis erteilt
// dieser Software und der dazugehörigen Dokumentationsdateien (die "Software") 
// um zu handeln in der Software ohne Einschränkung, einschließlich der Rechte
// zu verwenden, kopieren, modifizieren, zusammenführen, veröffentlichen, 
// verteilen, unterlizenzieren und / oder verkaufen
// Kopien der Software und um Personen zu erlauben, zu denen die Software 
// gehört dafür eingerichtet, unter den folgenden Bedingungen:
//
// Der obige Copyright-Hinweis und dieser Berechtigungshinweis sind in 
// enthalten alle Kopien oder wesentliche Teile der Software.
//
// DIE SOFTWARE WIRD "WIE BESEHEN" OHNE JEGLICHE GEWÄHRLEISTUNG, 
// AUSDRÜCKLICH ODER IMPLIED, EINSCHLIESSLICH, ABER NICHT BESCHRÄNKT 
// AUF DIE GARANTIE DER MARKTGÄNGIGKEIT,
// EIGNUNG FÜR EINEN BESTIMMTEN ZWECK UND NICHTVERLETZUNG
// AUTOREN ODER COPYRIGHT-INHABER HAFTEN FÜR ANSPRÜCHE, SCHÄDEN ODER ANDERE
// HAFTUNG, BEI EINER VERTRAGSMASSNAHME, VERSPÄRUNG ODER ANDERER WEIT
// NICHT ODER IN VERBINDUNG MIT DER SOFTWARE ODER DER VERWENDUNG ODER 
// ANDERER ABKOMMEN IN DIE SOFTWARE.
//-----------------------------------------------------------------------------
// French
//-----------------------------------------------------------------------------
// La permission est donnée gratuitement à toute personne, une copie
// de ce logiciel et des fichiers de documentation associés (le "Logiciel"), 
// pour traiter dans le logiciel sans restriction, y compris, sans limitation, 
// les droits utiliser, copier, modifier, fusionner, publier, distribuer, 
// concéder en sous-licence et / ou vendre copies du logiciel, 
// et pour permettre aux personnes à qui le logiciel est destiné
// fourni à cet effet, sous réserve des conditions suivantes:
//
// L'avis de copyright ci-dessus et cet avis de permission sont inclus dans
// toutes les copies ou parties substantielles du logiciel.
//
// LE LOGICIEL EST FOURNI "TEL QUEL", SANS GARANTIE D'AUCUNE SORTE, EXPRESSE OU
// IMPLICITE, Y COMPRIS, MAIS SANS S'Y LIMITER, 
// LES GARANTIES DE QUALITÉ MARCHANDE,
// APTITUDE À UN USAGE PARTICULIER ET À L’ABSENCE DE VIOLATION. EN AUCUN CAS, 
// LE LES AUTEURS OU LES TITULAIRES DE COPYRIGHT 
// SONT RESPONSABLES DE TOUTE RÉCLAMATION, DE DOMMAGES OU D'AUTRES
// RESPONSABILITÉ, QU'IL SOIT DANS UN ACTION DE CONTRAT, DE DÉLIT OU AUTREMENT, 
// RÉSULTANT DE, HORS OU EN LIEN AVEC LE LOGICIEL OU L'UTILISATION OU D'AUTRES 
// TRANSACTIONS DANS LE LOGICIEL.
//-----------------------------------------------------------------------------
// Italian
//-----------------------------------------------------------------------------
// L'autorizzazione è concessa, a titolo gratuito, a chiunque ne faccia una copia
// di questo software e dei relativi file di documentazione (il "Software"), da trattare
// nel Software senza restrizioni, inclusi senza limitazioni i diritti
// utilizzare, copiare, modificare, unire, pubblicare, distribuire, 
// sublicenziare e / o vendere
// copie del Software e per consentire a chi è il Software
// fornito di farlo, alle seguenti condizioni:
//
// La suddetta nota sul copyright e questo avviso di autorizzazione sono inclusi in
// tutte le copie o parti sostanziali del software.
//
// IL SOFTWARE VIENE FORNITO "COSÌ COM'È", SENZA GARANZIA DI ALCUN TIPO, ESPRESSA O
// IMPLICITE, INCLUSE, A TITOLO ESEMPLIFICATIVO, LE GARANZIE DI COMMERCIABILITÀ,
// IDONEITÀ PER UN PARTICOLARE SCOPO E NON VIOLAZIONE. IN NESSUN CASO IL
// AUTORI O DETENTORI DEL COPYRIGHT SARANNO RITENUTI RESPONSABILI PER 
// QUALSIASI RECLAMO, DANNO O ALTRO RESPONSABILITÀ, 
// SIA IN UN ATTO DI CONTRATTO, IN FATTO O ALTRIMENTI, DERIVANTE DA,
// FUORI O IN COLLEGAMENTO CON IL SOFTWARE O L'USO O ALTRE DISPOSIZIONI IN
// IL SOFTWARE.
//-----------------------------------------------------------------------------
// Spanish
//-----------------------------------------------------------------------------
// Por la presente se otorga permiso, sin cargo, a cualquier persona una copia
// de este software y los archivos de documentación relacionados (el "Software"), para tratar
// en el Software sin restricción, incluyendo sin limitación los derechos
// para usar, copiar, modificar, fusionar, publicar, distribuir, sublicenciar y / o vender
// copias del Software, y para permitir a las personas a quienes el Software está
// dispuesto a hacerlo, sujeto a las siguientes condiciones:
//
// El aviso de copyright anterior y este aviso de permiso se incluirán en
// todas las copias o partes sustanciales del Software.
//
// EL SOFTWARE SE PROPORCIONA "TAL CUAL", SIN GARANTÍA DE NINGÚN TIPO, EXPRESA O
// IMPLÍCITA, INCLUYENDO PERO NO LIMITADO A LAS GARANTÍAS DE COMERCIABILIDAD,
// APTITUD PARA UN PROPÓSITO PARTICULAR Y NO INCUMPLIMIENTO. EN NINGÚN CASO, EL
// LOS AUTORES O LOS TITULARES DEL DERECHO DE AUTOR SERÁN RESPONSABLES POR CUALQUIER RECLAMACIÓN, DAÑOS U OTROS
// RESPONSABILIDAD, YA SEA EN UNA ACCIÓN DE CONTRATO, TORTUNA O DE OTRA MANERA, DERIVADA DE,
// FUERA DE O EN CONEXIÓN CON EL SOFTWARE O EL USO O OTRAS REPARACIONES EN
// EL SOFTWARE.
//-----------------------------------------------------------------------------

//-----------------------------------------------------------------------------
// Set here Directives and namespaces (Project)
// Compiler 'Under the Hood', means he runs at coding, codeline for codeline,
// is precompile for a better and faster backend compile!.
// make sign on left site as yellow lamp! - in codeline scan, syntax/semantic
// blend out unused directives can be removed!
// stand at build running, he delete them, all space lines, unused variables,
// and comments...
//-----------------------------------------------------------------------------
using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using static System.Reflection.Assembly;
using System.Security;
using System.Runtime.CompilerServices;
using System.Web;
using System.Web.Configuration;


//-----------------------------------------------------------------------------
//
// In this Project-Solution you use in all other namespaces 
// from other Visual C# name.cs Files:
// Classes and Methods are static written set this:
// here bind in Visual.Operation.System.dll, inside Attribute
// [InternalsInvisibleAttribute("Visual.Galaxy.Framework"), AllInternals = true]
// All internals written are visible in Project 'Visual Galaxy Framework'
//-----------------------------------------------------------------------------

//
using static Visual.Galaxy.Framework.Core.VGFCore;

// static Class NativeMethods for Constants, Enumerator, Struct's, variables...
using static Visual.Operation.System.Native.NativeMethods;

// All Windows Operation System Functions
using static Visual.Operation.System.Native.UnsafeNativeMethods;

// Constants for MessageBox, StartUp
using static Visual.Operation.System.Internal.InternalUtilities.VOSInternalUtilities;

// Visual.Function.Library.dll - our Functions for use written in C/C++.


// All C/C++ Runtime Library Functions for use.
using static Visual.Operation.System.Native.NativeRuntimeMethods;

//
using Visual.Operation.System.Internal.InternalUtilities;


//-----------------------------------------------------------------------------
//
//-----------------------------------------------------------------------------
namespace Visual.Galaxy.Framework.Assembly
{
    /// <summary>
    /// Assembly Visual.Galaxy.Framework.dll
    /// </summary>
    /// <!-- Author 🧑TIPPLIN 🧑-->
    /// Specials Infos about Assembly Visual.Galaxy.Framework
    /// <!-- Author 🧑TIPPLIN 🧑-->
    /// <remarks>
    /// Assembly Informations - Properties from Class AssemblyInfo in AssemblyInfo.cs
    /// Used by Helper Functions to access information from Assembly Attributes
    /// ! ATTENTION ! insert directive System - using System; is Object Base
    /// for Type
    /// private readonly Type CurrentAssTyp;
    /// <summary>
    /// (System.Type) CurrentAssTyp assign to class VGFAssemblyInfo
    /// </summary>
    /// <!-- Author 🧑TIPPLIN 🧑-->
    /// Class Constructor VGFAssemblyInfo
    /// <!-- Author 🧑TIPPLIN 🧑-->
    /// <remarks>
    /// Initialize Field CurrentAssTyp with Typedeclaration and typeof(objectname).
    /// </remarks>
    /// public VGFAssemblyInfo()
    /// {
    ///     CurrentAssTyp = typeof(VGFAssemblyInfo);
    ///    
    /// }
    ///
    /// <summary>
    /// Get simple Name of Assembly
    /// </summary>
    /// public string VGFAsmName
    /// {
    ///     get
    ///     {
    ///         return CurrentAssTyp.Assembly.GetName().Name.ToString();
    ///     }
    /// } 
    /// </remarks>
    public static class VGFAssembly
    {

            /*********************************************************************************
             * Globals can you set here in class head!
             * instances, variables, instancevariables like
             * public static VGFAssemblyInfo vai = new VGFAssemblyInfo();
             * set classname VGF.Core as directive in Solution, 
             * so have directly access on class
             * vai.propertymember
             *
             * NOTE! without access modi, means public, protected, internal, private protected
             * the instance is private, is standard in C#.
             * but don't forget 'private' is degree of protection.
             *********************************************************************************
             *
             * Make different names for Class AssemblyInfo, if not the compiler make error message,
             * set first letter the short Assemblyname:
             * VGF = Visual Galaxy Framework   = VGFAssemblyInfo
             * VSL = Visual Security Library   = VSLAssemblyInfo
             * VEE = Visual Exception Engine   = VEEAssemblyInfo
             * VFL = Visual Form Library       = VFLAssemblyInfo
             * VRL = Visual Resource Library   = VRLAssemblyInfo 
             *
             *
             */
       
        
            /// <summary>
            /// Get Fullname of VGF Assembly
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <remarks>
            /// The Information come from AssemblyInfo.cs
            /// with Class VGFAssemblyInfo and Properties
            /// this Class is not normally !.
            /// </remarks>
            /// <returns>
            /// returned the full assembly name
            /// </returns>
            public static string VGFGetAssemblyName()
            {
                //
                // instancevariable is vai
                //           vai.AsmFQName
                return vai.VGFAsmFQName;
            }

            /// <summary>
            /// Get VGF Assembly Copyright
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <returns>
            /// 
            /// </returns>
            public static string VGFGetAssemblyCopyright()
            {
                return vai.VGFCopyright;
            }

            /// <summary>
            /// Get VGF Assembly current Version Number
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <returns></returns>
            public static string VGFGetAssemblyVersion()
            {
                return vai.VGFVersion;
            }

            /// <summary>
            /// Get VGF Assembly Company Name
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// Specials Infos about Visual.Galaxy.Framework.dll
            /// <!-- Author 🧑TIPPLIN 🧑--> 
            /// <returns>
            /// 
            /// </returns>
            public static string VGFGetAssemblyCompanyName()
            {
                return vai.VGFCompany;
            }

            /// <summary>
            /// Get VGF Assembly Product Name
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <returns></returns>
            public static string VGFGetAssemblyProductName()
            {
                return vai.VGFProduct;
            }

            /// <summary>
            /// Get VGF Assembly Description
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <returns></returns>
            public static string VGFGetAssemblyDescription()
            {
                return vai.VGFDescription;
            }

            /// <summary>
            /// Get VGF Assembly Title Name
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// 
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <returns></returns>
            public static string VGFGetAssemblyTitleName()
            {
                return vai.VGFTitle;
            }

            

            /// <summary>
            /// Assembly Visual.Operation.System.dll
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// Specials Infos about Assembly Visual.Operation.System.dll
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <remarks>
            /// Assembly infos about Visual.Operation.System.dll
            /// </remarks> 
            public static class VOSAssembly
            {
                

                /// <summary>
                /// Get Fullname of Visual Operation System Assembly
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyName()
                {
                    return vos.AsmFQName;
                }

                /// <summary>
                /// Get VOS Assembly Copyright 
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyCopyright()
                {
                    return vos.Copyright;
                }

                /// <summary>
                /// Get VOS Assembly current Version Number.
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyVersion()
                {
                    return vos.Version;
                }

                /// <summary>
                /// Get by Visual Operation System Assembly the Company Name
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyCompanyName()
                {
                    return vos.Company;
                }

                /// <summary>
                /// Get VOS Assembly Product Name
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyProductName()
                {
                    return vos.Product;
                }

                /// <summary>
                /// Get VOS Assembly Description
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyDescription()
                {
                    return vos.Description;
                }

                /// <summary>
                /// Get VOS Assembly Title Name
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VOSGetAssemblyTitleName()
                {
                    return vos.Title;
                }






            } // end of Class:.VOSAssembly

            /// <summary>
            /// Assembly Visual.Security.Library.dll
            /// </summary>
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// Specials Infos about Assembly Visual.Security.Library.dll
            /// <!-- Author 🧑TIPPLIN 🧑-->
            /// <remarks>
            /// Assembly infos about Visual.Security.Library.dll
            /// </remarks> 
            public static class VSLAssembly
            {
                /// <summary>
                /// Get Fullname of VSL Assembly
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyName()
                {
                    return vsl.AsmFQName;
                }

                /// <summary>
                /// Get VSL Assembly Copyright 
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyCopyright()
                {
                    return vsl.Copyright;
                }

                /// <summary>
                /// Get VSL Assembly current Version Number
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyVersion()
                {
                    return vsl.Version;
                }

                /// <summary>
                /// Get by Visual Security Library Assembly the Company Name
                /// </summary>
                /// <returns></returns>
                public static string VSLGetAssemblyCompanyName()
                {
                    return vsl.Company;
                }

                /// <summary>
                /// Get VSL Assembly Product Name
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyProductName()
                {
                    return vsl.Product;
                }

                /// <summary>
                /// Get VSL Assembly Description
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyDescription()
                {
                    return vsl.Description;
                }

                /// <summary>
                /// Get VSL Assembly Title Name
                /// </summary>
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
                /// <returns></returns>
                public static string VSLGetAssemblyTitleName()
                {
                    return vsl.Title;
                }






            } // end of Class:.VSLAssembly




    } // end of Namespace::VGFAssembly


    /// <summary>
    /// Some Methods as Helpers to an Assembly
    /// </summary>
    public class VGFAssemblyHelper
    {
        /// <summary>
        /// Load an Assembly Lazy with given Assemblyname
        /// </summary>
        /// <!-- Author 🧑TIPPLIN 🧑-->
                /// 
                /// <!-- Author 🧑TIPPLIN 🧑-->
        /// <param name="AssemblyName"></param>
        /// <returns></returns>
        public string VGFLoadAssemblyLazy(string AssemblyName)
        {
            try
            {
                LoadFrom(AssemblyName);
            }
            catch(SystemException ex)when(ex is FileNotFoundException | ex is FileLoadException)
            {
                VFLMsgBox(ex.Message, ex.Source, STYLES.OkOnly | STYLES.Exclamation | STYLES.MsgBoxSetForeground | STYLES.SystemModal);
                // return false as string 'false'
                return bool.FalseString;
            }

            // return true as string 'true'
            return bool.TrueString;

        }

        /// <summary>
        /// Internal Methods for the Assembly VGF.dll - Visual.Galaxy.Framework
        /// </summary>
        /// <!-- Author 🧑TIPPLIN 🧑-->
        /// Internals for Assembly, test or proof some relevant Settings.
        /// <!-- Author 🧑TIPPLIN 🧑-->
        internal static class VGFThisAssembly
        {
            /// <summary>
            /// current Version of Assembly
            /// </summary>
            internal static string AssemblyVersion = vai.VGFVersion;
            /// <summary>
            /// current file version of Assembly
            /// </summary>
            internal static string AssemblyFileVersion = vai.VGFAssFileVersion;
            /// <summary>
            /// current Informational Version of Assembly
            /// </summary>
            internal static string AssemblyInformationalVersion = vai.VGFAssInformationalVersion;
            /// <summary>
            /// current Assembly Name of Assembly
            /// </summary>
            internal static string AssemblyName = vai.VGFAsmName;
            /// <summary>
            /// current Title of Assembly
            /// </summary>
            internal static string AssemblyTitle = vai.VGFTitle;
            /// <summary>
            /// Debug or Release Assembly
            /// </summary>
            internal static string AssemblyConfiguration = vai.VGFAssConfigurationStatus;
            /// <summary>
            /// current Public Key of Assembly
            /// </summary>
            internal static string AssemblyPublicKey = vai.VGFAssSignatureKey;
            /// <summary>
            /// current Public Key Token of Assembly
            /// </summary>
            internal static string AssemblyPublicKeyToken = vai.VGFAssGUID;


          
        }








    } // END_OF_CLASS::VGFAssemblyHelper
















} // end of namespace:: Visual.Galaxy.Framework.Assembly
